{{ define "title" }}Novo Cliente{{ end }}
{{ define "content" }}
<!-- Container fluid -->
<div class="container-fluid p-6">
  <div class="row">
    <div class="col-lg-12 col-md-12 col-12">
      <!-- Page header -->
      <div class="border-bottom pb-4 mb-4">
        <div class="row align-items-center">
          <div class="col">
            <h3 class="mb-0 fw-bold">Cadastro de Cliente</h3>
            <p class="mb-0 text-muted">Preencha os dados do novo cliente</p>
          </div>
          <div class="col-auto">
            <div class="d-flex gap-2">
              <a href="/client" class="btn btn-outline-secondary">
                <i class="fa-solid fa-arrow-left icon-xs me-2"></i>
                Voltar
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- content -->
  <div class="py-6">
    <!-- row  -->
    <div class="row">
      <!-- card  -->
      <div class="col-xl-12 col-lg-12 col-md-12 col-12">
        <div class="card h-100">
          <!-- card body -->
          <div class="card-body">
            <form action="/client" method="post" id="client-form" novalidate>
              <div class="row">
                <div class="col-lg-8">
                  <!-- Seção Principal -->
                  <div class="mb-4">
                    <h5 class="mb-3">
                      <i class="fa-solid fa-circle-info icon-sm me-2"></i>
                      Informações Pessoais
                    </h5>
                    
                    <!-- Nome -->
                    <div class="mb-3">
                      <label for="name" class="form-label fw-semibold">Nome Completo <span class="text-danger">*</span></label>
                      <input type="text" class="form-control" id="name" name="name" value="{{ .Form.Name }}" required 
                             placeholder="Digite o nome completo">
                      <div class="form-text">
                        <i class="fa-solid fa-lightbulb icon-xs me-1"></i>
                        Digite o nome completo do cliente
                      </div>
                      {{with .Data.Errors.Name}}
                      <div class="text-danger small mt-1">
                        <i class="fa-solid fa-circle-exclamation icon-xs me-1"></i>{{.}}
                      </div>
                      {{end}}
                    </div>

                    <!-- CPF -->
                    <div class="mb-3">
                      <label for="cpf" class="form-label fw-semibold">CPF <span class="text-danger">*</span></label>
                      <input type="text" class="form-control cpf" id="cpf" name="cpf" value="{{ .Data.Form.CPF }}" 
                             placeholder="000.000.000-00" required>
                      <div class="form-text">
                        <i class="fa-solid fa-id-card icon-xs me-1"></i>
                        Digite apenas os números do CPF
                      </div>
                      {{with .Data.Errors.CPF}}
                      <div class="text-danger small mt-1">
                        <i class="fa-solid fa-circle-exclamation icon-xs me-1"></i>{{.}}
                      </div>
                      {{end}}
                    </div>

                    <!-- Data de Nascimento -->
                    <div class="mb-3">
                      <label for="data_nascimento" class="form-label fw-semibold">Data de Nascimento <span class="text-danger">*</span></label>
                      <input type="text" class="form-control date" id="data_nascimento" name="birthdate" value="{{ .Data.Form.Birthdate }}" placeholder="DD/MM/AAAA" required>
                      <div class="form-text">
                        <i class="fa-solid fa-calendar icon-xs me-1"></i>
                        Digite a data no formato DD/MM/AAAA
                      </div>
                      {{with .Data.Errors.Birthdate}}
                      <div class="text-danger small mt-1">
                        <i class="fa-solid fa-circle-exclamation icon-xs me-1"></i>{{.}}
                      </div>
                      {{end}}
                    </div>

                    <!-- Email -->
                    <div class="mb-3">
                      <label for="email" class="form-label fw-semibold">Email <span class="text-danger">*</span></label>
                      <input type="email" class="form-control" id="email" name="email" value="{{ .Data.Form.Email }}" 
                             pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required 
                             placeholder="exemplo@email.com">
                      <div class="form-text">
                        <i class="fa-solid fa-envelope icon-xs me-1"></i>
                        Digite um email válido
                      </div>
                      {{with .Data.Errors.Email}}
                      <div class="text-danger small mt-1">
                        <i class="fa-solid fa-circle-exclamation icon-xs me-1"></i>{{.}}
                      </div>
                      {{end}}
                    </div>

                    <!-- Telefone -->
                    <div class="mb-3">
                      <label for="phone" class="form-label fw-semibold">Telefone <span class="text-danger">*</span></label>
                      <div class="input-group">
                        <input type="tel" class="form-control phone_with_ddd" id="phone" name="phone" value="{{ .Data.Form.Phone }}" 
                               placeholder="(XX) X XXXX-XXXX" required>
                      </div>
                      <div class="form-text">
                        <i class="fa-solid fa-phone icon-xs me-1"></i>
                        Digite o telefone com DDD
                      </div>
                      {{with .Data.Errors.Phone}}
                      <div class="text-danger small mt-1">
                        <i class="fa-solid fa-circle-exclamation icon-xs me-1"></i>{{.}}
                      </div>
                      {{end}}
                    </div>
                  </div>
                </div>

                <div class="col-lg-4">
                  <!-- Dicas -->
                  <div class="mb-4">
                    <h6 class="mb-3">
                      <i class="fa-regular fa-lightbulb icon-sm me-2"></i>
                      Dicas para Cadastro
                    </h6>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-3 d-flex align-items-start">
                        <i class="fa-solid fa-circle-check icon-sm text-success me-2 mt-1"></i>
                        <span>Verifique se o CPF está correto</span>
                      </li>
                      <li class="mb-3 d-flex align-items-start">
                        <i class="fa-solid fa-circle-check icon-sm text-success me-2 mt-1"></i>
                        <span>Use um email válido e ativo</span>
                      </li>
                      <li class="mb-3 d-flex align-items-start">
                        <i class="fa-solid fa-circle-check icon-sm text-success me-2 mt-1"></i>
                        <span>Inclua o DDD no telefone</span>
                      </li>
                    </ul>
                  </div>

                  <!-- Ações -->
                  <div>
                    <div class="d-grid gap-2">
                      <button type="submit" class="btn btn-primary" id="submitBtn">
                        <i class="fa-solid fa-save icon-sm me-1"></i>
                        Salvar Cliente
                      </button>
                      <a href="/client" class="btn btn-secondary">
                        <i class="fa-solid fa-arrow-left icon-sm me-1"></i>
                        Cancelar
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // Máscara para CPF
    const cpfInput = document.getElementById('cpf');
    cpfInput.addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) {
            value = value.slice(0, 11);
        }
        if (value.length <= 11) {
            value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
            value = value.replace(/(\d{3})(\d{3})(\d{3})/, "$1.$2.$3");
            value = value.replace(/(\d{3})(\d{3})/, "$1.$2");
        }
        e.target.value = value;
    });

    // Máscara para telefone
    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 11) {
            value = value.slice(0, 11);
        }
        let formattedValue = '';
        if (value.length > 0) {
            if (value.length > 0) {
                formattedValue += '(' + value.slice(0, 2) + ')';
                value = value.slice(2);
            }
            if (value.length > 0) {
                formattedValue += ' ' + value.slice(0, 5);
                value = value.slice(5);
            }
            if (value.length > 0) {
                formattedValue += '-' + value.slice(0, 4);
            }
        }
        e.target.value = formattedValue;
    });

    // Validação do formulário
    const form = document.getElementById('client-form');
    const submitBtn = document.getElementById('submitBtn');
    
    form.addEventListener('submit', function (e) {
        if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();
        } else {
            // Mostrar loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fa-solid fa-spinner icon-sm me-1 animate-spin"></i> Salvando...';
        }
        form.classList.add('was-validated');
    });
});
</script>
{{ end }}